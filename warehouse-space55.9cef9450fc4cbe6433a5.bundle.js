(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1548:function(module,exports,__webpack_require__){var dP=__webpack_require__(129).f,FProto=Function.prototype,nameRE=/^\s*function ([^ (]*)/;"name"in FProto||__webpack_require__(97)&&dP(FProto,"name",{configurable:!0,get:function(){try{return(""+this).match(nameRE)[1]}catch(e){return""}}})},1550:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return taskLevelMap})),__webpack_require__.d(__webpack_exports__,"a",(function(){return taskLevelKeyValue})),__webpack_require__.d(__webpack_exports__,"d",(function(){return taskStatusMap})),__webpack_require__.d(__webpack_exports__,"c",(function(){return taskStatusKeyValue}));__webpack_require__(102),__webpack_require__(158),__webpack_require__(1548);var taskLevelMap=[{key:4,name:"最高",color:"#FF3939",bgColor:"rgba(255,57,57, 0.1)"},{key:3,name:"中等",color:"#FFA85A",bgColor:"rgba(255,168,90,1, 0.1)"},{key:2,name:"普通",color:"#2682FF",bgColor:"rgba(38,130,255,1, 0.1)"},{key:1,name:"低",color:"#00B97E",bgColor:"rgba(0,185,126,1, 0.1)"}],taskLevelKeyValue=taskLevelMap.reduce((function(total,item){return total[item.key]=item.name,total}),{}),taskStatusMap=[{key:2,name:"已完成",color:"#00B97E",bgColor:"rgba(0,185,126,0.10)"},{key:1,name:"未完成",color:"#FFA350",bgColor:"rgba(255,163,80,0.20)"}],taskStatusKeyValue=taskStatusMap.reduce((function(total,item){return total[item.key]=item.name,total}),{})},683:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(17),__webpack_require__(29),__webpack_require__(9),__webpack_require__(271),__webpack_require__(36),__webpack_require__(41),__webpack_require__(42),__webpack_require__(19),__webpack_require__(10),__webpack_require__(43),__webpack_require__(23),__webpack_require__(37);var defineProperty=__webpack_require__(12),vuex_esm=(__webpack_require__(402),__webpack_require__(193)),utils_const=__webpack_require__(1550);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null!=arguments[i]?arguments[i]:{},i%2?ownKeys(Object(source),!0).forEach((function(key){Object(defineProperty.a)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}));return target}var task_addTaskvue_type_script_lang_js_={name:"",props:{editData:{type:Object,default:function _default(){return{}}},projectId:{type:Number,default:0},parentId:{type:Number,default:0},checklistId:{type:Number,default:0},isEdit:{type:Boolean,default:!1},userlist:{type:Array,default:function _default(){return[]}}},data:function data(){return{form:{title:"",content:"",principal_id:void 0,principal_name:"",orderby:void 0,type:null,endtime:null,starttime:null},rules:{title:[{required:!0,trigger:"change",message:"标题不能为空"}],content:[{required:!0,trigger:"change",message:"描述不能为空"}],principal_id:[{required:!0,trigger:"change",message:"负责人不能为空"}],type:[{required:!0,trigger:"change",message:"优先级不能为空"}],endtime:[{required:!0,trigger:"change",message:"截止日期不能为空"}],starttime:[{required:!0,trigger:"change",message:"开始日期不能为空"}]},priorityList:utils_const.b}},computed:{principalList:function principalList(){return this.$store.state.userinfo.department_user_list},principalName:function principalName(){var _this=this,res=this.userlist.filter((function(item){return item.uid==_this.form.principal_id}));return 0<res.length?res[0].realname:""}},methods:_objectSpread(_objectSpread({},Object(vuex_esm.b)("task/task",["addTask","editTask"])),{},{cancel:function cancel(){this.$emit("update:visible",!1)},resetForm:function resetForm(){this.form={title:"",content:"",endtime:null,starttime:null,principal_id:void 0,principal_name:"",type:null},this.$refs.form.resetFields()},onSubmit:function onSubmit(){var _this2=this;this.$refs.form.validate((function(valid){valid&&(_this2.isEdit?(_this2.form.endtime=_this2.form.endtime/1e3,_this2.form.starttime=_this2.form.starttime/1e3,_this2.editTask(_this2.form).then((function(){_this2.$emit("success"),_this2.$nextTick((function(){_this2.resetForm()}))}))):(_this2.form.project_id=_this2.projectId,_this2.form.task_list_id=_this2.checklistId,_this2.form.parentId=_this2.parentId,_this2.form.endtime=_this2.form.endtime/1e3,_this2.form.starttime=_this2.form.starttime/1e3,_this2.addTask(_this2.form).then((function(){_this2.$emit("success"),_this2.$nextTick((function(){_this2.resetForm()}))})).catch((function(){_this2.$emit("success")}))))}))}}),watch:{editData:{handler:function handler(newVal){var _this3=this;this.$nextTick((function(){newVal.task_id&&(_this3.form=Object.assign({},newVal),_this3.form.endtime=1e3*_this3.form.endtime,_this3.form.starttime=1e3*_this3.form.starttime)}))},immediate:!0,deep:!0},isEdit:{handler:function handler(newVal){var _this4=this;newVal||this.$nextTick((function(){_this4.resetForm()}))},immediate:!0,deep:!0}}},componentNormalizer=__webpack_require__(96),component=Object(componentNormalizer.a)(task_addTaskvue_type_script_lang_js_,(function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"wrap-form",staticStyle:{padding:"0"}},[_c("el-form",{ref:"form",staticClass:"my-form",attrs:{model:_vm.form,rules:_vm.rules,"label-position":"top","label-width":"80px"}},[_c("el-form-item",{attrs:{label:"任务标题",prop:"title"}},[_c("el-input",{attrs:{rows:3,placeholder:"标题"},model:{value:_vm.form.title,callback:function($$v){_vm.$set(_vm.form,"title","string"==typeof $$v?$$v.trim():$$v)},expression:"form.title"}})],1),_vm._v(" "),_c("el-row",{attrs:{gutter:4}},[_c("el-col",{attrs:{span:6}},[_c("el-form-item",{attrs:{label:"负责人",prop:"principal_id"}},[_c("el-select",{attrs:{placeholder:"请指定负责人",filterable:""},model:{value:_vm.form.principal_id,callback:function($$v){_vm.$set(_vm.form,"principal_id",_vm._n($$v))},expression:"form.principal_id"}},_vm._l(_vm.userlist,(function(item){return _c("el-option",{key:item.uid,attrs:{label:item.realname,value:item.uid}})})),1)],1)],1),_vm._v(" "),_c("el-col",{attrs:{span:6}},[_c("el-form-item",{attrs:{label:"优先级",prop:"type"}},[_c("el-select",{attrs:{placeholder:"请选择优先级"},model:{value:_vm.form.type,callback:function($$v){_vm.$set(_vm.form,"type",_vm._n($$v))},expression:"form.type"}},_vm._l(_vm.priorityList,(function(item){return _c("el-option",{key:item.key,attrs:{label:item.name,value:item.key}},[_c("span",{style:{color:item.color}},[_vm._v(_vm._s(item.name))])])})),1)],1)],1),_vm._v(" "),_c("el-col",{attrs:{span:6}},[_c("el-form-item",{attrs:{label:"开始日期",prop:"starttime"}},[_c("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"timestamp"},model:{value:_vm.form.starttime,callback:function($$v){_vm.$set(_vm.form,"starttime",$$v)},expression:"form.starttime"}})],1)],1),_vm._v(" "),_c("el-col",{attrs:{span:6}},[_c("el-form-item",{attrs:{label:"截止日期",prop:"endtime"}},[_c("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"timestamp"},model:{value:_vm.form.endtime,callback:function($$v){_vm.$set(_vm.form,"endtime",$$v)},expression:"form.endtime"}})],1)],1)],1),_vm._v(" "),_c("el-form-item",{attrs:{label:"任务描述",prop:"content"}},[_c("el-input",{attrs:{type:"textarea",rows:6,placeholder:"描述"},model:{value:_vm.form.content,callback:function($$v){_vm.$set(_vm.form,"content","string"==typeof $$v?$$v.trim():$$v)},expression:"form.content"}})],1)],1),_vm._v(" "),_c("div",{staticClass:"submit-box"},[_c("el-button",{staticClass:"submit-btn",attrs:{type:"primary"},on:{click:_vm.onSubmit}},[_vm._v("保存")]),_vm._v(" "),_c("el-button",{staticClass:"submit-btn",attrs:{type:""},on:{click:_vm.cancel}},[_vm._v("取消")])],1)],1)}),[],!1,null,null,null);__webpack_exports__.default=component.exports}}]);
//# sourceMappingURL=warehouse-space55.9cef9450fc4cbe6433a5.bundle.js.map